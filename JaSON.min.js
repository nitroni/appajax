$(document).ready(function(){JaSON.init()});
var JaSON={init:function(){JaSON.startTime=0;JaSON.endTime=0;$("#url").focus();JaSON.loadSavedRequests(!1);JaSON.registerEventHandlers()},registerEventHandlers:function(){$("#saved-requests").on("click",".saved-request",JaSON.copySavedRequest);$("#add-header-action").on("click",JaSON.addHeaderInput);$("#headers").on("click",".delete-header-action",function(){$(this).parents(".header").remove()});$("#send").on("click",JaSON.sendRequest);$("#reset").on("click",JaSON.resetAndClear);$("#clear-saved-requests-action").on("click",
JaSON.clearSavedRequests);$("#response-tab, #response-headers-tab, #raw-response-tab").on("click",JaSON.manageTabs);$("#method, #content-type").on("change",JaSON.manageRequestBody);$("#request-body").on("change",JaSON.handleRequestBodyClear);$("#url").keypress(function(a){13==a.which&&(a.preventDefault(),JaSON.sendRequest())})},reset:function(){$(".nav-tabs li").removeClass("active");$(".nav-tabs li:first").addClass("active");$("#response-code").hide();$("#response-code").html("");$("#response-code").removeClass("label-danger label-success");
$("#response-time").hide();$("#response-time").html("");$("#response").hide();$("#response").html("");$("#raw-response").hide();$("#raw-response").html("");$("#response-headers").hide();$("#response-headers").html("");$(".help-block").hide();$(".form-group").removeClass("has-error")},resetAndClear:function(){JaSON.reset();$("#url").val("");$("#method").val("GET");$("#content-type").val("application/json");$("#request-body").val("");$("#request-body").data("value","");$("#headers .header").remove()},
clearSavedRequests:function(){$("#saved-requests").empty();$("#saved-requests-row").hide();localStorage.clear()},copySavedRequest:function(){var a=$(this).attr("id"),b=JSON.parse(localStorage[a]);JaSON.reset();$(this).effect("transfer",{to:$(".main")},300,function(){$("#url").val(b.url);$("#method").val(b.method);$("#content-type").val(b.contentType);$("#request-body").val(b.requestBody);$("#headers .header").remove();$(b.headers).each(function(){JaSON.addHeaderInput(this[0],this[1])});$("#raw-response").text(b.response);
$("#response-code").html(b.responseCode);$("#response-code").addClass(b.responseCodeClass);$("#response-time").html(b.responseTime);$("#response-headers").html(b.responseHeaders);JaSON.processResponseData(b.contentType,b.response);$("#url, #method, #content-type, #request-body, #headers .name, #headers .value, #response-code, #response-time, #response").effect("highlight",{},1E3);""==$("#response").html()&&$("#response").hide();JaSON.manageRequestBody()})},validate:function(){var a=!0;""==$("#url").val().trim()&&
(a=!1,$("#url").focus(),$("#url-group").addClass("has-error"),$("#url-error").show());var b=[];$(".header").each(function(){var c=$(".name",this).val().trim().toLowerCase(),d=$(".value",this).val().trim(),e="";if(c==""||d==""){a=false;e="Header name and value are required"}else if(b.indexOf(c)>=0){a=false;e="A header with this name already exists"}else b.push(c);if(!a){$(".help-block",this).html(e);$(".form-group",this).addClass("has-error");$(".help-block",this).show()}});var c=$("#request-body").val().trim(),
d=$("#content-type").val();if(""!=c)if("application/json"==d||"application/x-www-form-urlencoded; charset=UTF-8"==d)try{$.parseJSON(c)}catch(e){a=!1,$("#request-body-error").html("Invalid JSON: "+e.message),$("#request-body-group").addClass("has-error"),$("#request-body-error").show()}else if("text/xml"==d||"application/xml"==d)try{$.parseXML(c)}catch(f){a=!1,$("#request-body-error").html(f.message),$("#request-body-group").addClass("has-error"),$("#request-body-error").show()}return a},manageTabs:function(){$("#response-tab, #response-headers-tab, #raw-response-tab").removeClass("active");
$(this).addClass("active");var a=$("#response"),b=$("#response-headers"),c=$("#raw-response");switch($(this).attr("id")){case "response-tab":b.hide();c.hide();""!=a.html()&&a.show();break;case "response-headers-tab":a.hide();c.hide();""!=b.html()&&b.show();break;case "raw-response-tab":a.hide(),b.hide(),""!=c.html()&&c.show()}},manageRequestBody:function(){var a=$("#request-body");a.val()&&a.data("value",a.val());var b=$("#method").val(),c=$("#content-type").val();"POST"==b||"PUT"==b||"application/x-www-form-urlencoded; charset=UTF-8"==
c?(a.val(a.data("value")),a.prop("disabled",!1)):(a.val(""),a.prop("disabled",!0))},handleRequestBodyClear:function(){""==$("#request-body").val().trim()&&$("#request-body").data("value","")},sendRequest:function(){JaSON.reset();if(!JaSON.validate())return!1;$("#loading").show();var a=$("#content-type").val(),b={url:JaSON.getURL("#url"),type:$("#method").val(),contentType:a,processData:!1,beforeSend:JaSON.processHeaders,data:$("#request-body").val().trim(),success:JaSON.successResponse,error:JaSON.errorResponse};
"application/x-www-form-urlencoded; charset=UTF-8"==a&&""!=b.data&&(b.processData=!0,b.data=JSON.parse(b.data));JaSON.startTime=(new Date).getTime();$.ajax(b)},saveRequest:function(){var a=[];$(".header").each(function(){var b=$(".name",this).val().trim(),c=$(".value",this).val().trim();a.push([b,c])});var b=moment().format(),c=JSON.stringify({url:$("#url").val(),method:$("#method").val(),contentType:$("#content-type").val(),headers:a,requestBody:$("#request-body").val(),responseCode:$("#response-code").text(),
responseCodeClass:$("#response-code").attr("class"),response:$("#raw-response").text(),responseTime:$("#response-time").text(),responseHeaders:$("#response-headers").text()});localStorage[b]=c;JaSON.loadSavedRequests(!0)},loadSavedRequests:function(a){$("#saved-requests").empty();var b=[],c;for(c in localStorage)b.push(c);b.sort().reverse();for(var d=0;d<b.length;d++)if(c=b[d],250>d){var e=JSON.parse(localStorage[c]),f=e.url.replace(/http(s)?:\/\//,"");$("#saved-requests").append(Handlebars.templates.savedRequest({id:c,
shortUrl:f,longUrl:e.url,date:moment(c).format("YYYY/MM/DD HH:mm:ss"),method:e.method}))}else localStorage.removeItem(c);0<$(".saved-request").size()&&($("#saved-requests-row").show(),a&&$(".saved-request:first").effect("highlight",{},1E3));$(".saved-request").tooltip({placement:"bottom",container:"body",html:!0,delay:{show:500,hide:100}})},getURL:function(a){a=$(a).val().trim();return 0!=a.indexOf("http")?"http://"+a:a},processHeaders:function(a){$(".header").each(function(){var b=$(".name",this).val().trim(),
c=$(".value",this).val().trim();""==b||""==c?$(this).remove():a.setRequestHeader(b,c)})},successResponse:function(a,b,c){JaSON.processResponse(c,!0);JaSON.saveRequest()},errorResponse:function(a){JaSON.processResponse(a,!1)},processResponse:function(a,b){JaSON.endTime=(new Date).getTime();$("#response-code").addClass(b?"label-success":"label-danger");$("#response-code").html(a.status+": "+a.statusText);$("#response-time").html(JaSON.endTime-JaSON.startTime+"ms");$("#response-headers").html(a.getAllResponseHeaders());
var c=a.responseText,d=a.getResponseHeader("Content-Type");$("#raw-response").text(c);JaSON.processResponseData(d,c);$("#loading").hide();$("#response-code").show();$("#response-time").show();""!=$("#response").html()&&$("#response").show()},processResponseData:function(a,b){if(JaSON.isJson(a))try{$("#response").text(JSON.stringify(JSON.parse(b),null,2))}catch(c){$("#response").text(b)}else $("#response").text(b);1E4>b.length&&($("#response, #response-headers").removeClass("prettyprinted"),prettyPrint())},
isJson:function(a){var b="application/json,application/x-javascript,application/javascript,text/javascript,text/x-javascript,text/x-json".split(",");return null!=a&&b.some(function(b){return 0==a.indexOf(b)})},isXml:function(a){var b=["text/xml","application/xml","text/xml-external-parsed-entity","application/xml-external-parsed-entity","application/xml-dtd"];return null!=a&&b.some(function(b){return 0==a.indexOf(b)})},addHeaderInput:function(a,b){$("#headers").append(Handlebars.templates.requestHeader({name:"string"==
typeof a?a:"",value:"string"==typeof b?b:""}));$("#headers .name:last").focus()}},_gaq=_gaq||[];_gaq.push(["_setAccount","UA-30163240-1"]);_gaq.push(["_trackPageview"]);(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://ssl.google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();
